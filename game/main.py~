import sys
from PyQt4 import QtCore, QtGui
from main_ui import Ui_MainWindow
import soldier
import leaders
import random
import units

class MyForm(QtGui.QMainWindow):
    def __init__(self, parent=None):

        # initialise interface and its components
        QtGui.QWidget.__init__(self, parent)
        self.ui = Ui_MainWindow()
        self.ui.setupUi(self)

        # next we create a player
        player = units.Player('my@email.com', 'secretpassword', 'username')
        # add squad for a player
        player.add_new_squad('CapTree', 'HierTree', 'Scotland')
        # and we create some soldiers
        soldier1 = units.Soldier()
        soldier2 = units.Soldier()
        # add solderis to the players squad
        player.list_of_squads[0].add_to_roster(soldier1)
        player.list_of_squads[0].add_to_roster(soldier2)

        self.populate_soldier_list(player, 0)
        self.populate_leaders_list()

    def soldier(self):
        item = QtGui.QListWidgetItem(self.ui.listWidget)
        item_widget = soldier.Soldier_icon_("It works")
        item.setSizeHint(item_widget.sizeHint())
        #self.ui.listWidget.addItem(item)
        self.ui.listWidget.setItemWidget(item,item_widget)

    def soldier2(self, player, i, j):
        #item = QtGui.QListWidgetItem(self.ui.listWidget)
        item_widget = soldier.Soldier_icon_(`i`+`j`)
        print(item_widget)
        item_widget2 = soldier.Soldier_icon_(`j`+`i`)
        item_widget2.retranslate_widget(player)
        #item.setSizeHint(item_widget.sizeHint())
        #self.ui.gridLayout.addWidget(item_widget)
        self.ui.soldiers_bt.addWidget(item_widget2, i, j)
        self.ui.soldiers_roster.addWidget(item_widget, i, j)
        #self.ui.listWidget.setItemWidget(item,item_widget)

    def leaders(self, i, j):
        item_widget = leaders.Ui_("It works")
        item_widget2 = leaders.Ui_("It works2")
        self.ui.leaders_bt.addWidget(item_widget2, i, j)
        self.ui.leaders_roster.addWidget(item_widget, i, j)

    def populate_soldier_list(self, player, squad_number):
        squad = player.list_of_squads[squad_number]
        number_of_soldiers = len(squad.roster)     # number of soldiers in a roster
        row = 0
        col = 0
        for i in range(1,number_of_soldiers+1):
            if i % 3 == 0:
                self.soldier2(player, row, col)
                row += 1
                col = 0
            else:
                self.soldier2(player, row, col)
                col += 1

    def populate_leaders_list(self):
        self.leaders(0,0)
        self.leaders(0,1)


if __name__ == "__main__":
    app = QtGui.QApplication(sys.argv)
    myapp = MyForm()
    myapp.show()
    sys.exit(app.exec_())
